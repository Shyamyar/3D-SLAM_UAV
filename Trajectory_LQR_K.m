function K = Trajectory_LQR_K(A, B)

%% Q_e Tuning for Error
q1 = 0.1;
q2 = 0.1;
q3 = 0.1;
q4 = 0.1;
q5 = 0.1;
q6 = 0.1;
q7 = 0.04;
Q_e = [ 1/q1^2, 0, 0, 0, 0, 0, 0;
        0, 1/q2^2, 0, 0, 0, 0, 0;
        0, 0, 1/q3^2, 0, 0, 0, 0;
        0, 0, 0, 1/q4^2, 0, 0, 0;
        0, 0, 0, 0, 1/q5^2, 0, 0;
        0, 0, 0, 0, 0, 1/q6^2, 0;
        0, 0, 0, 0, 0, 0, 1/q7^2];

%% R_e Tuning for Control
r1 = 0.2;
r2 = sqrt(0.1);
r3 = 0.1;
R_e = [ 1/r1^2, 0, 0, 0;
        0, 1/r2^2, 0, 0;
        0, 0, 1/r2^2, 0;
        0, 0, 0, 1/r3^2];
[Pe, K, L] = icare(A, B, Q_e, R_e, [], [], []);